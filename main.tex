\documentclass[12pt]{report}
\usepackage{graphicx}

\begin{document}

% ------------------------------------------------------------------------

\chapter{Introduction}

% Here I would like a brief motivation for the work.
% Perhaps also a bit of theory goes here?

% ------------------------------------------------------------------------

\chapter{Ion Trap Apparatus}
    A vast effort is spent on the initial build-up of the an ion trap system, but
    throughout the life of the experiment, a greater effort is spent on its daily
    maintenance.  I hope that this chapter will serve as a resource for future
    members of the FastGates team, as well as provide a useful recipe for anyone
    building a similar system. \\

    Due to the size and complexity of the system, we introduce an inital overview of
    the design, motivated by the desired functions.  As the name suggests, an ion
    trap experiment aims to confine arrays of single ions, this is achieved by
    static and dynamic electric fields which, due to the ions possesing non-zero
    electric charge, can provide trapping potentials, section~\ref{sec:The Ion
    Trap}. Due to the fragility of the internal states of the ion (these are state
    of the art sensors after all), we must take great care in isolating the ion from
    any noisy environment. This neccesitates the use of ultra-high vacuum (UHV)
    systems, section~\ref{sec:Vacuum System}, vibration isolation, and magnetic
    shielding, section~\ref{sec:Magnetic Field}. To manipulate the internal electronic states of the ion, we create
    local electric and magnetic fields using RF antennae and, in this work, lasers,
    sections~\ref{sec:Laser systems} and~\ref{sec:Narrow Line Width 729 Laser}.
    Finally, to interface with the apparatus we have built, at the time scales set by our interaction strengths, we require a sophisticated and custom control system which is discussed in section~\ref{sec:Sinara Hardware}.

\section{System Design}
\label{sec:System Design}
% figures for section
    % Block diagram of the system
    % Calcium level structure 
    % Solidworks models

\section{The Ion Trap}
\label{sec:The Ion Trap}
% figures for section
    % NPL trap with relevant size scales

% Potentially this lives in characterisation?
\subsection{Trap RF Chain}
\subsection{Trap DC Voltages}

\section{Beam Geometries and Vacuum System}
\label{sec:Vacuum System}
% figures for section
    % Technical drawing of beam geometries and magnetic field to ion chain.
    % Drawing of ion trap package with high NA lenses
    % Standing waves at the ion
\subsection{Vacuum System}
\subsection{Atomic Source Oven}
\subsection{Optical Access}
\subsubsection{Beam Paths}
\subsubsection{In Vacuum Prisms}
\subsubsection{Dual High NA Objectives}
\subsection{Imaging System}

\section{Magnetic Field}
\label{sec:Magnetic Field}

\section{Laser systems}
\label{sec:Laser systems}
% figures for section
    % Table of all AOMs and offset frequencies
    % Table of laser powers in mW and with aimed saturation intensities for doppler idle, cooling, readout
\subsection{Photoionisation}
\subsection{Ca$^+$ Laser Systems}	
\label{sec:Ca+ Laser Systems}

% All frequencies and powers and how we control these. PDH lock, AOM etc.

\subsection{Narrow Line Width 729 Laser}
\label{sec:Narrow Line Width 729 Laser} 
% figures for section
    % Solstis cavity
    % Beam path and control loops (PDH, FNC)

\subsection{Single Addressing System}
\label{sec:Single Addressing System}
% figures for section
    % single addressing system creating standing waves
    % render of single addressing system

\section{Sinara Hardware and Artiq}
\label{sec:Sinara Hardware}
% figures for section
    % Table of sinara hardware


% ------------------------------------------------------------------------

\chapter{Experiment Characterisation}

    Before we can dive into running novel experiments involving the motion and spin
    of the atoms, we need to characterise our apparatus. This allows us to both
    benchmark our system against state of the art results, and to reveal any
    current limitations of the apparatus which we may need to address.

\section{Available Transitions}
\label{sec:Transitions}
% figures for section
    % All visible motional modes on large detuning scan at $5$~G. Can compare when have all quadrupole transitions available or when we selectively omit transitions via polarisation.

\section{Spin}
\label{sec:Spin}

\subsection{Rabi and Ramsey Scans}
    % Mention changing polarisation to select certain transitions
    Here we briefly describe the method in which we extract Rabi frequencies and single qubit gate durations.
    % 1 mW 729~nm laser -> Fit out pi/2, pi, 2pi pulses. We are using square pulses.

\subsection{Extracting Laser Offset and Magnetic Field}

\subsection{Spin Coherence Times}
    Individual gate fidelities are ultimately limited by loss of coherences of
    the two qubit states due to either dephasing or by the natural lifetime of the upper level. By our choice of ion and qubit levels, defined between
    the ground $4S_{1/2}$ state and the metastable $3D_{5/2}$ state, we can
    expect a lifetime limited coherence time of $\tau = 1.1$~s~\cite{}. 
    %Barton, P. A. et al. Measurement of the lifetime of the 3d 2D5/2 state in
    %40Ca+.Physical Review A 62, 032503 (2000).
    In practise, mainly due to imperfect tracking of laser frequency and
    magnetic field drifts (as mentioned above), we see coherence times dominated
    by dephasing. To discern between these two noise sources, we may exploit the
    fact that we have multiple Zeeman levels within our $3D_{5/2}$ state with
    varying magnetic field sensitivities. We also have the ability to define our
    qubit on the Zeeman split ground state, which decouples dephasing due to the
    laser from measured coherence times. We perform Ramsey scans with varying
    mid-sequence delay durations to extract the coherence times, an example of
    which can be seen in figure~\ref{fig:coherence_times}. In characterising the
    spin coherence times, we hope to explore both the efficacy of the magnetic
    shielding surrounding the ion trap, as well as the stability of the 729~nm
    laser. \\
    Figure~\ref{fig:coherence_times} shows how the magnetic shielding effect
    coherence times of three transitions, XX, YY and ZZ, with magnetic field
    sensitivities of XX, YY and ZZ respectively.  From this we find that without
    the shielding, we are strongly limited by external magnetic field noise, and
    with full sheilding we suppress this noise to where we are dominated by
    laser phase noise. To find the factor by which the magnetic field noise is
    attenuated, we can compare the coherence times of the laser phase
    insensitive transition with and without the box. We find an attenuation
    factor of XX, which is XXconsisitent with the expected attenuation factor of
    the mu-metal shielding.\\
    With the shiedling in place, we compare the coherence times of the
    $4S_{1/2}, m_j = -1/2 \leftrightarrow 3D_{5/2}, m_j = -5/2$ with fibre noise cancellation (see
    section~\ref{sec:Narrow Line Width 729 Laser}) and without, figure~\ref{fig:coherence_times}. We find that the
    coherence time is improved by a factor of XX, with FNC enabled. Our current
    spin coherence time of XX~ms is limited by the laser phase noise, and we
    expect to be able to push this to [ref R. Oswald] by improving the laser PDH
    stability. However, for the immediate planned experiments (see
    section~\ref{Outlook}), these improvements will be a low priority due to
    other likely dominating error sources in the motion of our ions.\\

\subsection{State Preparation and Measurement}
    % State preparation via optical pumping
    % Readout characterisation with NA 0.6 lens
    % Compare readout histograms of fast 30 us readout to Doppler cold 100 us readout
    To utilise two levels of the ion as a qubit, we need to be able to
    selectively prepare the ion into one of the Zeeman levels of the ground
    state. As mentioned in section~\ref{sec:Magnetic Field}, we are operating at
    a low magnetic field of 5~G, leading to a splitting between the Zeeman
    levels of less than 21~MHz, the natural linewidth of the 397~nm transition.
    This means we cannot optically pump using 397~nm frequency selectivity.
    Further, due to the constraint of beam geometry from the in vacuum optics,
    we can not use polarisation selectivity of the 397~nm transition. Instead,
    we use the narrow line width 729~nm laser on resonance with the $4S_{1/2},
    m_j = +1/2 \leftrightarrow 3D_{5/2}, m_j = -3/2$ transition, and the 854~nm
    deshelving laser on resonance, to optically pump into the $m_j = -1/2$
    Zeeman level we define as our qubit ground state. \\
    To measure the qubit state of the ion, we apply the 397~nm and 866~nm lasers
    and count 397~nm photons scattered. From the level diagram shown in
    figure~\ref{fig:level_diagram}, we can see that upon turning on the 397~nm
    laser, if we are in $|0\rangle$, photons will be scattered, and if we are in
    $|1\rangle$, then no photons will be scattered. To optimise the fidelity of
    measurement we ensure that the signal is discernible with low error from any
    background counts on the camera. In general, improving the number of signal
    counts can be achieved by tuning the 397~nm laser near to the transition
    resonance, by increasing the readout duration, or by increasing the
    percentage of scattered photons captured by the imaging system. Practically
    we desire that the readout step does not heat the motion of the ion and so
    we red detune the 397~nm laser to a similar setting as for Doppler cooling
    (see section~\ref{sec:Cooling}). The parameters we use for readout are
    summarised in table~\ref{tab:readout_parameters}, and a typical histogram of
    readout counts for one and two ions can be seen in
    figure~\ref{fig:readout_histogram}. We find that the readout fidelity is
    XXX.\\
    To measure the effect of state preparation and measurement error on longer
    experimental sequences, we will discuss randomised benchmarking in
    section~\ref{sec:Randomised Benchmarking}. Due to the relevance here, we
    quote the measured state-preparation and measurement error (SPAM) of XXX.\\
    
\subsection{Randomised Benchmarking}
\label{sec:Randomised Benchmarking}
    % Calibrating gate times
    % Randomised bench marking of single qubit gates


\section{Motion}
\label{sec:Motion}

\subsection{Finding Motional Mode Frequencies}

\subsection{Motional Mode Stability}

\subsection{Cooling}
\label{sec:Cooling}
    % Doppler cooling
    % Sideband cooling
    For any interaction involving the motion of the ion, we require both the
    ability to prepare the motional state with high fidelity, and to
    subsequently measure this motional state to verify correct preparation. For
    entangling gates, and the creation of squeezed states which we are
    considering in this chapter, we assume that we begin in the motional ground
    state, or in other words, Fock state zero.  Our initially trapped ions will
    be in some high temperature thermal state, (*given by the oven temperature
    and the PI laser momenta kicks*). We first doppler cool our ions, and then
    subsequently sideband cool them. We give a brief description of these two
    cooling processes here.\\

    \subsubsection{Doppler Cooling}
    Doppler cooling exploits the fact that incident light onto a moving ion will
    appear frequency shifted in the rest frame of the ion. For Doppler cooling
    of $^{40}$Ca$^+$, we apply both the 397~nm and 866~nm lasers. We initially red
    detune the 397~nm laser by around 100~MHz. This results in the preferential
    absorption of a quanta of 397~nm light by ions with a velocity vector
    antiparallel photon k-vector. After this absorption, the ion will be in the
    excited $4P_{3/2}$ state and spontaneously decay to either the $4S_{1/2}$,
    or the $3D_{3/2}$ emitting a photon of either 397~nm or of 866~nm
    respectively into a random direction. These two decay paths have a branching
    ratio of XX.  As we desire many photon kicks to cool our ions, we repump the
    electron out of this metastable $3D_{3/2}$ level by applying an on resonant
    866~nm beam.  The absorption and sequential emission of this 397~nm photon
    will lead to a net reduction in the motional energy of the ion if the photon
    is emitted at a higher energy than when absorbed. The equilibrium
    temperature is given by the condition where the doppler cooling rate is
    equal to photon recoil heating of the ion. Assuming a Lorentzian absorption
    profile, the minimum temperature is given by,
    \begin{equation}
    T_{Doppler} \approx \frac{\hbar\gamma}{2k_B},
    \end{equation}
    where $\hbar$ is the reduced Planck constant, $\gamma$ is the natural
    linewidth of the transition, and $k_B$ is Boltzmann's constant.\\ For
    $^{40}$Ca$^+$, the natural linewidth of the 397~nm transition is $\frac{\gamma}{2\pi} =
    21$~MHz, leading to a Doppler temperature of approximately 0.5~mK. Given a radial mode frequency of $\frac{\omega}{2\pi} = 4$~MHz, and the mean occupation number of the oscillator being given by,
    %[ref NIST https://www.physics.nist.gov/PhysRefData/Handbook/Tables/calciumtable4.htm] 
    \begin{equation}
        \bar{n} = \frac{1}{e^{\hbar\omega/k_B T}-1},
    \end{equation}
    we find the final thermal distribution to have an expected Fock state of $\bar{n} = 2.3$.
    Using parameters summarised in table~\ref{tab:cooling_parameters}, we find practically the final temperature after Doppler cooling to be around XXX~mK.\\

    \subsubsection{Sideband Cooling}

    To further cool the ions toward their motional ground state, we use resolved
    sideband cooling. The motion of the ion, described by a harmonic oscillator,
    modulates the transition frequencies of the ion, leading to sidebands at
    multiples of the motional frequency. For the $4S_{1/2} \leftrightarrow
    3D_{5/2}$ transition, at appropriate laser intensity and motional mode
    frequencies, these sidebands can be resolved spectroscopically. The pulsed
    sideband technique we employ consists of red sideband pulses, followed by
    deshelving, and repumping pulses on the 854~nm and 866~nm transitions
    respectively. An example pulse sequence can be seen in
    figure~\ref{fig:sideband_cooling_sequence}, and experimental parameters we use are summarised in table~\ref{tab:cooling_parameters}.\\
    To verify the efficacy of our sideband cooling, we perform thermometry
    experiments by driving on resonance red sideband (RSB) and pi-RSB-pi pulse
    sequences. We record the time dynamics of population flopping as we vary RSB
    pulse length. In the case of Fock state zero, we expect to see a strong
    signal on the RSB, and no signal on the pi-RSB-pi pulses. We fit a thermal
    Fock state distribution (with truncation at Fock state = 100) to these
    signals to extract the mean occupation number, and $\eta\Omega$, the carrier
    Rabi frequency multiplied by the Lamb-Dicke parameter. A typical thermometry
    scan after Doppler and sideband cooling can be seen in
    figure~\ref{fig:sideband_cooling_results}. We find that the mean occupation
    number after sideband cooling is $\bar{n} = 0.03()$, and $\eta\Omega =
    XX$~MHz.\\
    Optimisation of the cooling parameters can be roughly performed by fitting
    temperature while scanning RSB pi-pulse durations, total number of pulses,
    repumping and deshelving times. One can optimise for minimum temperature,
    however it is also important to optimise for total cooling duration. For
    single ion, single mode experiments, this duration is often a non-issue,
    however for multi-ion crystals, any interaction involving the motion, may
    require the sequential sideband cooling of multiple motional modes. This can
    not be easily parallalised due to the requirement that the RSB pi-pulse is
    performed near resonance to one of the motional sidebands. This sequential
    cooling strategy can be either limiting when heating and cooling rates are
    comparable, or in the best case, painful due to long data collection times.\\
    To mitigate this issue, other sub-Doppler cooling techniques with larger
    accepted frequency bandwidths may be employed. Examples are dark-resonance
    cooling[], and electromagnetically induced transparency (EIT) cooling[], and
    Sisyphus cooling[]. These techniques are not yet implemented in our system,
    but will be likely additions once we move to larger ion crystals.\\

\subsection{Heating Rates}
    As mentioned, the cooling of our ions is only relevant if we have acceptable
    heating rates. Heating of the motion is predominantly caused by the ion trap
    itself. This can be due to imperfections in the surface of exposed
    dielectric and metals causing stray fields, or can be due to noise on the DC
    and RF drive voltages[]. Noise due to the surface of the trap can be
    mitigated by increasing ion-electrode distances, or by using traps with
    smaller surface area direclty exposed to the ion. In our case, as mentioned
    in sections~\ref{sec:The Ion Trap}, the NPL trap has an electrode ion
    distance somewhat larger than most surface traps, but less than that of a
    macroscope blade or rod style trap. To verify the heating rate of our
    system, we performed a series of thermometry scans whilst varying some delay
    time between cooling and thermometry pulses. A typical plot can be seen in
    figure~\ref{fig:heating_rate}. We find that the heating rate of our system
    is approximately $30$XX quanta per second on the upper radial 4~MHz mode on
    one ion.\\
    It is expected that the heating rate will be larger for lower frequency
    motional modes if we assume uniform electric field noise. We also verify
    this by looking at heating rate on the radial mode while varying the axial
    mode frequency. This is a useful diagnostic to check for unexpected heating
    at certain frequencies, perhaps due to RF noise in the lab. We find....\\

\subsection{Motional Coherence Times}

\section{Experimental Control}
\label{sec:Experimental Control}
% figures for section
    % Recrystallisation routines
    % Autoload routines
    % Morningly calibrations

\section{Spin-Dependent Forces}
\label{sec:Spin-Dependent Forces}
    The spin-dependent force (SDF) is (planned to be) heavily used throughout
    this thesis. We use the Mølmer-Sørensen (MS) scheme~\cite{}, to generate the
    SDF via a bichromatic laser field. Bichromatic refers to the simultaneous
    application of two tones symmetrically detuned around the qubit carrier
    frequency, with absolute detuning approximately equal to the motional mode
    frequency, $\delta \approx \omega_{m}$. The resulting interaction, when
    ignoring off resonant and higher order couplings, is given by,
    \begin{equation}
        \hat{H}_{MS} = \hbar \eta\Omega~\hat{\sigma}_\phi\cos(\delta t) \left( a e^{-i\omega_{m} t} + a^\dagger e^{i\omega_{m} t} \right),
    \end{equation}
    where $\eta$ is the Lamb-Dicke parameter, $\Omega$ is the carrier Rabi
    frequency, $a(a^\dagger)$ is the lowering (raising) operator, and
    $\sigma_\phi$ is the Pauli operator with $\phi$ being in the $x,~y~$-plane.
    Applying the rotating wave approximation, and defining $\delta_g = \delta -
    \omega_{m}$, we find that the interaction Hamiltonian can be approximated
    to,
    \begin{equation}
        \hat{H}_{MS} = \frac{\hbar \eta\Omega}{2}~\hat{\sigma}_\phi \left( a e^{-i\delta_g t} + a^\dagger e^{i\delta_g t} \right).
    \end{equation}
    The SDF realises a displacement of the motional state in phase space. We may
    control the trajectory of this displacement by varying $\delta_g$: on
    resonance, $\delta_g = 0$, we see linear trajectories, whilst off resonance,
    $\delta_g \neq 0$, we see cyclic trajectories where after some time $t =
    2\pi/\delta_g$, the motion returns to the initial state. We shall exploit
    this control in both the two-qubit entangling gate experiments, as well as
    in the creation of squeezed states.\\

\subsection{Calibrating the SDF}
    The MS interaction is widely used in ion trap experiments due to it being robust against varying intial motional states, and to the effects of heating during the pulse sequence. However, in our use case, the SDF is sensitive to miscalibration of the central qubit frequency, the balancing of power in the two tones, and to motional mode drifts. The first two miscalibrations appear as the SDF having..
    % Here describe what error sources "look like"
    % Describe detuning and duration scans
    We use both ``detuning'' and ``duration'' scans to calibrate the SDF. The
    ``detuning'' scan is performed by varying the detuning, $delta_g$, of the interaction, whilst the keeping the SDF duration constant, whilst the ``duration'' scan keeps detuning constant and varies the SDF duration.
    % Describe how we can detect these errors via the above strategy. Refer to OB thesis.
    % Fit an SDF with the errors?

\section{Two-Qubit Entangling Gates}
\label{sec:Two-Qubit Entangling Gates}
\subsection{Collective Motion of Two Ions}
\subsection{Mølmer-Sørensen Gate}
\subsubsection{Theoretical Background to the MS Gate}
\subsubsection{Experimental Implementation of the MS Gate}
    % Discuss likely limitations being nearby hot motional modes, no pulse ramping

\section{Creating Squeezed States}
\label{sec:Squeezed States}
\subsection{Calibrations}

% ------------------------------------------------------------------------

\chapter{Outlook}

% Here I would like to briefly describe the next steps in the project, as well
% as the future expeiments we want to demonstrate.

% ------------------------------------------------------------------------

\clearpage


\clearpage
\section{Appendix}

\end{document}