\chapter{Experimental Characterisation}
\label{ch:Characterisation}
\minitoc

    Before we can proceed with our planned experiments involving the motion and
    spin of the atoms, the apparatus must be characterised. This characterisation
    serves two purposes: it allows us to benchmark the performance of our system
    against state-of-the-art results, and it reveals any current limitations
    that must be addressed before we can successfully carry out the experiments.\\
    As discussed above, we are interested in two paradigms: discrete variable quantum computing (DVQC), that concerns the manipulation of qubits (or spins), and continuous variable quantum computing (CVQC), that concerns the manipulation of qumodes (or harmonic motion).\\
    For DVQC, we must have access to the following elementary operations:
    \begin{itemize}
        \item Qubit state preparation, here via optically pumping the electronic state of the ion into one sublevel of the $4S_{1/2}$ manifold --- the lower level of our qubit, section~\ref{sec:Stateprep}.
        \item Measurement of the qubit state, here via state-dependent fluorescence, section~\ref{sec:Measurement}.
        \item Single qubit rotations, here via interaction with the 729-nm laser, section~\ref{sec:Single Qubit Gates}
        \item Two qubit entangling-gates, here via spin-dependent forces (SDFs), using the 729-nm laser and the motional modes of the ion, section~\ref{sec:Two-Qubit Entangling Gates}.
    \end{itemize}
     For CVQC, we need:
    \begin{itemize}
        \item Motional state preparation, here via Doppler cooling and sideband cooling, section~\ref{sec:Cooling}.
        \item Measurement of the motional state, which is not yet implemented on our system but will follow~\cite{fluhmann2020direct}.
        \item Single and two qumode gates, which are also not yet implemented, but will utilise SDFs following~\cite{sutherland2021universal}, section~\ref{sec:Spin-Dependent Forces}.
    \end{itemize}
    We split this chapter into interactions involving only the spin, then those focussed only on the motion, and finally we describe spin-motion interactions.
    First, however, we describe the ion, its level structure, and the relevant lasers to manipulate its state.


\section{The Ion}
\label{sec:Transitions}
% Main points:
    % All visible motional modes on large detuning scan at $5$~G. 
    % Can compare when have all quadrupole transitions available or when we selectively omit transitions via polarisation.
% Pre reqs:
    % 5 G field
    \begin{figure}[ht]
        \begin{center}
        \noindent\includegraphics[width=\linewidth]{figures/pdf_figure/ion.pdf}
        \end{center}
        \caption{
        Electronic energy levels of \textsuperscript{40}Ca\textsuperscript{+},
        which will be used in this thesis. The levels are
        split by the Zeeman effect due to a $5.4$~G external magnetic field (they are shown explicitely only for the qubit manifolds). The
        transitions marked are required for cooling and control over the
        ion. The chosen qubit levels are labelled with $\ket{\downarrow}$, $\ket{\uparrow}$.
        }

    \label{fig:ion}
    \end{figure}

    \begin{figure}
        \vspace*{-0.5cm}
        \begin{center}
        \noindent\includegraphics[width=0.65\linewidth]{
            figures/pdf_figure/qp_gamma.pdf
            }
        \vspace*{-0.5cm}
        \noindent\includegraphics[width=0.65\linewidth]{
            figures/pdf_figure/qp_transition_spectrum_0.50.pdf
            }
        \vspace*{-0.5cm}
        \noindent\includegraphics[width=0.65\linewidth]{
            figures/pdf_figure/qp_transition_spectrum_0.25.pdf
            }
        \end{center}
        \vspace*{-0.5cm}
        \caption{
            Normalised quadrupole Rabi frequencies, $\Omega$, and frequency splittings for the $4S_{1/2} \leftrightarrow 3D_{5/2}$ Zeeman sublevels in \ca. Solid bars correspond to transitions with lower state $\ket{4S_{1/2},~m_j = -1/2}$, while open bars correspond to transitions with lower state $\ket{4S_{1/2},~m_j = +1/2}$.
            \textbf{a)} Relative Rabi frequencies as angle $\gamma$ between the polarisation vector and the magnetic field is varied. The k-vector of the light is assumed to be perpendicular to the B-field.
            \textbf{b)} Relative frequency splittings and strengths when $\gamma = \pi/2$. This is the polarisation chosen for the current and future experiments to reduce the number of transitions which can cause off-resonant interactions when the qubit defined by $\ket{4S_{1/2},~m_j = -1/2} \leftrightarrow \ket{3D_{5/2},~m_j = -5/2}$ is used.
            \textbf{c)} Relative frequency splittings and strengths when $\gamma = \pi/4$. At this angle, all transitions are accessible apart from those with $\Delta m_j = 0$. This is the polarisation chosen for our initial experiments to allow access to all transitions for characterisation.
            }
        \label{fig:quadrupole}
    \end{figure}

    The \ca ion has a rich level structure, shown in figure~\ref{fig:ion}, with many accessible quadrupole transitions $4S_{1/2}\leftrightarrow 3D_{5/2}$. The quadrupole transition is ideal for use as a qubit due to the long-lived metastable level ($\tau=1.1$~\unit{\s})~\cite{barton2000measurement}, and the ability to optically couple the transition via a laser. As mentioned in section~\ref{sec:Narrow Line Width 729 Laser}, the 729-nm beam is used for this purpose. By selecting the appropriate frequency of the 729-nm beam, qubit operations such as state preparation (section~\ref{sec:Stateprep}) and single qubit gates (section~\ref{sec:Single Qubit Gates}) may be driven, or by setting the detuning such that a motional sideband is near resonance, to couple the spin and motional degrees of freedom (section~\ref{sec:Spin-Dependent Forces}). Here, we discuss which quadrupole transitions are used, and the rationale behind their choice.\\ 
    Zeeman splitting of the $4S_{1/2}$ and $3D_{5/2}$ states leads to 2 and 6
    non-degenerate sublevels, respectively. Due to the magnetic field strength of 5.4~G (section~\ref{sec:Magnetic Field}),
    the $S$-levels are split by $\sim$15~\unit{\MHz}, and the $D$-levels by $\sim$9~\unit{\MHz}.
    This splitting is considerably larger than both the natural linewidth of the
    729-nm transition ($\sim$\unit{\Hz}), and the Ti:Sapph laser linewidth (<1~\unit{\kHz}), meaning the transitions can be 
    selectively addressed by frequency tuning of the laser. There is some freedom in choosing which of these 10 possible (with $\Delta m_j \leq 2$) quadrupole transitions we define as our qubit. Each transition has a varying coupling strength, here denoted by the relative Rabi frequency, $\Omega$, depending on the polarisation and $k$-vector of the interacting light with respect to the B-field axis. The desired criteria for qubit and polarisation choice are as follows:
    \begin{itemize}
    \item Access to a closed-cycle transition for sideband cooling, (for details on this, see section~\ref{sec:Cooling}). Closed-cycle here means $\ket{4S_{1/2},~m_j = -1/2} \rightarrow \ket{3D_{5/2}} \rightarrow \ket{4P_{3/2},~m_j = -3/2} \rightarrow \ket{4S_{1/2},~m_j = -1/2}$.
    \item The qubit transition needs a large quadrupole matrix element, leading to a high Rabi frequency, $\Omega$, to enable laser-power-efficient, fast, gates. Polarisation, $\gamma$, may be optimised to increase this coupling.
    \item Ideally the qubit transition should have a low magnetic field sensitivity, to reduce the effect of magnetic field noise. Using a MuMetal enclosure around the experiment does relax this constraint, see section~\ref{sec:Magnetic Field}.
    \item To reduce the effects of off-resonant interactions due to nearby transitions, it is desirable to limit the number of accessible transitions near to the qubit transition. This is done by selecting a polarisation, $\gamma$, such that unwanted transitions are suppressed.
    \end{itemize}
    Given these criteria, we use the transition $\ket{4S_{1/2},~m_j = -1/2} \leftrightarrow \ket{3D_{5/2},~m_j = -5/2}$ with magnetic field sensitivity 
    $-0.446$~\unit{\MHz\per\gauss}. Closed-cycle sideband cooling is possible with this same transtion, and state preparation via optical pumping is done via $\ket{4S_{1/2},~m_j = +1/2} \leftrightarrow \ket{3D_{5/2},~m_j = -3/2}$ with magnetic field sensitivity $-0.624$~\unit{\MHz\per\gauss}. \\
    Figure~\ref{fig:quadrupole} $a$, shows the normalised Rabi frequencies of each transition as the angle $\gamma$ between polarisation vector and B-field is varied. Here only linearly-polarised light with k-vector perpendicular to the B-field direction is considered.
    The polarisation of the 729-nm laser is set to $\gamma = \pi/2$ (black dashed line), which maximises the Rabi frequency of the qubit transition, while suppressing nearby transitions apart from that needed for state preparation. 
    Figure~\ref{fig:quadrupole} $b$, shows the relevant frequency splitting of the transitions at $\gamma = \pi/2$, which is the set polarisation for all experiments apart from initial quadrupole characterisation.
    For initial characterisation of the quadrupole transitions, the polarisation was set to $\gamma = \pi/4$, which allowed access to all transitions apart from those forbidden by the beam geometry, $\Delta m_j = 0$, see figure~\ref{fig:quadrupole} $c$. \\
    Other required lasers for manipulating the ion are: the 397-nm and 866-nm lasers used to form a closed-cycle for fluorescence, the 854-nm laser used to deshelve the ion from the $3D_{5/2}$ level for qubit state preparation. Details on these lasers can be found in section~\ref{sec:Laser systems}.
    

\section{Spin}
\label{sec:Spin}
    Discrete variable quantum computing consists of manipulating many two-level
    systems, which we refer to either as spins, or qubits. In this section 
    the methods used to maniplate these spins are described, and their
    performances are benchmarked.\\

\subsection{State Preparation}
\label{sec:Stateprep}
% Main points:
    % Method of preparation via optical pumping
    % Quote state prep error (back this from RBM + measurement histograms)
% Pre reqs:
    % Laser systems powers
    % 729 system
    % Available transitions
    % pi-pulses

    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=0.75\linewidth]{
            figures/pdf_figure/state_prep.pdf
            }
        \end{center}
        \caption{
            State preparation error as a function of the number of state preparation pulses, $N$. The error is defined as population not in the $\ket{\downarrow}$ state after the preparation sequence has been applied. The error is reduced to below $10^{-3}$ after $N=7$ pulses, which is used in our experiments.
            }
        \label{fig:stateprep}
    \end{figure}

\begin{table}
    \begin{center}
    \begin{tabular}{|c|l|}
        \hline
        Parameter & Value \\
        \hline
        729-nm laser power & 1000~\unit{\uW}\\
        729-nm laser detuning & 0~\unit{\MHz}* \\
        729-nm pulse duration & 5~\unit{\us} \\
        854-nm laser power & 60~\unit{\uW}, $250\times I_{\rm SAT}$\\
        854-nm laser detuning & 0~\unit{\MHz} \\
        854-nm pulse duration & 40~\unit{\us} \\
        866-nm laser power & 15~\unit{\uW}, $\sim 70\times I_{\rm SAT}$\\
        866-nm laser detuning & 0~\unit{\MHz} \\
        866-nm pulse duration & 30~\unit{\us} \\
        \hline
    \end{tabular}
    \end{center}
    \caption{
        * With respect to qubit transition frequency.\\
        Experimental parameters used for state preparation of the ion into the $\ket{\downarrow} = \ket{4S_{1/2},~m_j = -1/2}$ state.
        }
    \label{tab:state_prep_parameters}
\end{table}

    To utilise two levels of the ion as a qubit, the electronic state must first be prepared into the qubit manifold. Here, the ion is prepared into the $\ket{\downarrow}=\ket{4S_{1/2},~m_j=-1/2}$ state. 
    This is done via effective optical pumping by pulsing the quadrupole transition $\ket{4S_{1/2},~m_j = +1/2} \leftrightarrow \ket{3D_{5/2},~m_j = -3/2}$,
    followed by deshelving pulses using the 854-nm, 866-nm
    lasers on resonance.  The 729-nm laser pulse duration and intensity is set to invert the populations, i.e. perform a $\pi$-pulse. Details for laser parameters are summarised in table~\ref{tab:state_prep_parameters}. These three pulses are repeated $N$ times sequentially. Figure~\ref{fig:stateprep} shows the state preparation error with increasing $N$. The error is found by applying a $\pi$-pulse on the state preparation transition directly after the state preparation sequence and looking at the population in the $\ket{\downarrow}$ state. Any reduction from $\ket{\downarrow} = 1$ indicates residual population in the $\ket{4S_{1/2},~m_j = +1/2}$ state, or the $D$ levels. After $N=7$ pulses, which is used in our experiments, there is a state preparation error of $<10^{-3}$. This is further verified by randomised benchmarking in section~\ref{sec:Single Qubit Gates}. The state preparation error is likely limited by accidental excitation of the $\ket{4S_{1/2},~m_j = -1/2}$ state to the $D_{5/2}$ level. This may be due to off-resonant excitation of another transition, or due to spectral purity of the 729-nm laser. \\
    Another protocol for state preparation is optical pumping on the dipole transition (397-nm), which often is much faster. However, in this setup it is impractical as polarisation selectivity of the 397-nm transition is not possible due to 
    the constraint of beam geometry from the in vacuum optics, see section~\ref{sec:Vacuum System},
    and frequency selectivity is not possible due to the low magnitude fixed B-field providing Zeeman shifts less than the natural linewidth of the 397-nm transition, see section~\ref{sec:Magnetic Field}. 


\subsection{Measurement}
\label{sec:Measurement}
% Main points:
    % Readout characterisation with NA 0.6 lens
    % Compare readout histograms of fast 30 us readout to Doppler cold 100 us readout
    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=0.75\linewidth]{
            figures/pdf_figure/readout_hist.pdf
            }
        \end{center}
        \caption{
            Readout histogram with 100,000 individual measurements for bright (red) and dark (blue) populations. The camera counts are presented as a histogram and fitted to Poissonian distributions to calibrate a threshold for discerning if the ion is bright or dark with the lowest probability for false measurement. Dark counts are mainly due to 397-nm light scattered from the nearest trap electrodes. With 100~\unit{\us} readout duration, and laser parameters set to Doppler cooling parameters, a threshold count of 137 photons is found, giving an expected statistical error of $6\times 10^{-9}$ given the fitted Gaussians. %Gaussian dark: mean = 62, $\sigma$ = 13. Gaussian bright: mean = 341, $\sigma$ = 36.
            }
        \label{fig:readout_histogram}
    \end{figure}

    \begin{table}
        \begin{center}
        \begin{tabular}{|c|l|}
            \hline
            Parameter & Value \\
            \hline
            397-nm laser power & 3~\unit{\uW}, $1\times I_{\rm SAT}$ \\
            397-nm laser detuning & -17.5~\unit{\MHz}\\
            866-nm laser power & 15~\unit{\uW}, $\sim 70\times I_{\rm SAT}$\\
            866-nm laser detuning & 0~\unit{\MHz} \\
            Doppler cooling duration & 1000~\unit{\us}\\
            Readout duration & 100~\unit{\us} \\
            Camera threshold & 137 counts \\
            \hline
        \end{tabular}
        \end{center}
        \caption{
            Experimental parameters used for Doppler cooling and state-selective fluorescence of the ion. 
            }
        \label{tab:397_parameters}
    \end{table}

    To measure the qubit state, the 397-nm and 866-nm lasers
    are applied, and the scattered 397-nm photons are imaged by the objective onto a camera (see section~\ref{sec:Imaging System}). 397-nm light will only be scattered if the qubit is in $\ket{\downarrow}$.
    Use of a high numerical aperture (NA = 0.6) objective greatly increases the collection efficiency.
    This efficiency allows the 397-nm beam to be red-detuned to Doppler cooling parameters (see section~\ref{sec:Cooling}), while still maintaining low readout duration (100~\unit{\us}) and low readout error. 
    Cooling during readout increases the experiment's repetition rate by reducing the amount of dedicated cooling time required.\\
    The parameters used for readout are
    summarised in table~\ref{tab:397_parameters}, and a typical histogram of
    readout counts for one ion can be seen in
    figure~\ref{fig:readout_histogram}. The readout threshold is calibrated by taking bright counts with the 397-nm and 866-nm lasers on, and dark counts with the 397-nm laser on and the 866-nm laser off. This assumes dark counts are due to 397-nm scattering from the trap electrodes. 
    Fitting Poissonian distributions to the bright and dark measurements, an optimal count threshold of
    137 is found, shown by black dashed line. This threshold gives an expected
    statistical readout error of $\epsilon_\downarrow = \epsilon_\uparrow = 6\times10^{-9}$, where $\epsilon_{\downarrow,\uparrow}$ are the expected error associated with measuring bright or dark. This measurment ignores errors due to the
    finite lifetime of the metastable $3D_{5/2}$ level, which dominate $\epsilon_\uparrow$. The expected error due
    to the finite lifetime, $\tau$, is $\epsilon_{\rm decay} = 1 - e^{-t/\tau}$, where $t$ is the readout duration. For \ca, $\tau \sim 1.1$~s, $\epsilon_\uparrow \approx \epsilon_{\rm decay}  = 
    10^{-4}$. 
    Assuming the metastable lifetime is limited only by spontaneous decay overlooks leakage from the 854-nm deshelving beam, which could significantly shorten $\tau$~\cite{sotirova2024high-fidelity}. \\
    
\subsection{Single Qubit Rotations}
\label{sec:Single Qubit Gates}
% Main points:
    % Here is a characterisation of single qubit gates.
    % Explain RBM method
    % Quote values measured
    % What is likely error source
    % Are we limited by this error?
    % What is state of the art (for optical quadrupole transition)
    % What contribution is the spin coherence time?
% Pre reqs:
    % Spin coherence times
    % Possible transitions
    % Calibrating gate times
    A qubit is fully described by $\ket{\psi} = \alpha\ket{\downarrow} + \beta\ket{\uparrow}$, where $\alpha$ and $\beta$ are complex numbers satisfying $|\alpha|^2 + |\beta|^2 = 1$. The qubit state can be manipulated by applying single qubit rotations, $R_{x,y}(\theta)$, commonly referred to as gates. In the Bloch sphere, $x$- and $y$-rotations are performed by pertubations resonant with the qubit transition, here, using the 729-nm laser. The rotation angle, $\theta$, is given by $\theta=\Omega t/2$, where $\Omega$, is the Rabi frequency, and $t$ is the pulse duration. The rotation axis, is determined by the relative phase of the light field and the qubit. We define the initial relative phase to correspond to a $y$-rotation.

\subsubsection{Gate Time Calibration}
% Main points:
    % The ion is a sensor!
    % Method for Rabi and Ramsey scans
    % Mention changing polarisation to select certain transitions
    % Long Rabi flop
    % Likely reason for flop damping
    % Measuring detuning using Ramsey scan
% Pre reqs:
    % 729 system
    % Available Quadrupole transitions

    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=\linewidth]{
            figures/pdf_figure/long_flop.pdf
            }
        \end{center}
        \caption{Long duration, $t$, Rabi flop on the qubit transition to extract Rabi frequency. Estimated probability of being in $\ket{\downarrow}$, $P_\downarrow$, at each time step using 200 individual experimental shots. Fitted dotted line using decaying oscillation model. Extracted Rabi frequency $\Omega/2\pi = 0.2864(2)$~\unit{\MHz}, and decay rate $\lambda = 0.0107(7)$~\unit{\per\us}. 
            }
        \label{fig:Long Flop}
    \end{figure}

    The pulse duration, for a $R(\pi/2)$ ($\pi/2$-pulse), is calibrated by Rabi oscillations. Figure~\ref{fig:Long Flop} shows the population in $\ket{\downarrow}$, $P_\downarrow$, calculated from 200 experimental shots.
    To find the Rabi frequency, $\Omega$, the data is fitted to a decaying oscillation model,
    \begin{equation}
        P_{\downarrow} = \frac{1 + e^{-\lambda t} \cos(\Omega t/2)}{2},
    \end{equation}
    where $\lambda$ is the decay rate due to decoherence
    effects~\cite{wineland1998experimental}. The Rabi frequency is found to be
    $\Omega/2\pi = 0.2864(2)$~\unit{\MHz}, and the decay rate $\lambda =
    0.0107(7)~1/\mu$s.
    From this $R(\pi/2) = 1.7$~\unit{\us} can be estimated.
    These measurements were taken with 1~mW of 729-nm power,
    with beam radius $\sim$15\unit{\um} at the ion.\\
    

\subsubsection{Randomised Benchmarking}

    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=0.75\linewidth]{
            figures/pdf_figure/rbm_fit.pdf
            }
        \end{center}
        \caption{
            Estimating single qubit Clifford fidelities, $\mathcal{F}$, and errors due to state preparation and measurement, using randomised benchmarking. 
            The data points are the average survival population after applying a sequence of $m$ random Clifford gates, and a final inverting Clifford gate. The dashed line is the fit to the decay model given by equation~\ref{eq:RBM_decay}. The error bars are given by the standard deviation of the survival populations.
            }
        \label{fig:rbm}
    \end{figure}

    To evaluate the quality of both our
    state preparation and single qubit rotations, randomised benchmarking
    (RBM)~\cite{knill2008randomized} is employed.  RBM consists of
    applying random combinations of gates from the single-qubit Clifford group to
    estimate an average error per gate. The single-qubit Clifford group is
    the set of unitaries which map the Pauli matrices to one another through
    conjugation. The RBM protocol used here is described in~\cite{hughes2021benchmarking}.
    The sequence of operations is as follows:
    \begin{enumerate}
        \item Prepare the qubit in $\ket{\downarrow}$ via optical pumping, section~\ref{sec:Stateprep}.
        \item Apply a random sequence of $m$ single qubit Clifford gates, where $m$ is the length of the sequence.
        \item Apply a final ``inverting'' Clifford gate, which is chosen such that the full sequence performs the identity operation.
        \item Measure the population in $\ket{\downarrow}$, $P_\downarrow$, via state-selective fluorescence, section~\ref{sec:Measurement}.
        \item Repeat steps 1-4 multiple times to find the average survival population, $\langle P_\downarrow \rangle$.
        \item Repeat steps 1-5 for many different random sequences with a range of sequence lengths, $m$.
        \item Fit the decay of the average survival population, $\mathcal{F}(m) = \langle P_\downarrow(m) \rangle$, to a decay model to find the average error per Clifford gate.
    \end{enumerate}
    The decay model used to find 
    the fidelity versus number of Clifford gates is given by\cite{hughes2021benchmarking},
    \begin{equation}
    \label{eq:RBM_decay}
        \mathcal{F}(m) = \frac{1}{2}\left( 1+(1-2\epsilon_{\rm SPAM})(1-2\epsilon_c)^m\right),
    \end{equation}
    where $\mathcal{F}(m)$ is the fidelity of the sequence of length $m$,
    $\epsilon_{\rm SPAM}$ is the state preparation and measurement error, and
    $\epsilon_c$ is the average error per Clifford gate.  The Clifford gates are decomposed into
    sequences of $\pi/2$- and $\pi$-pulses about either the $x$- or $y$-axes. Up to $m=100$ Clifford gates are probed, and the decay of the fidelity, $\mathcal{F}(m)$, is fit using the above model.
    The error per Clifford is found to be $\epsilon_c = 9.5(3) \times 10^{-4}$,
    while the SPAM error is $\epsilon_{\rm SPAM} = 1.46(6) \times 10^{-3}$. The decay plot for
    this RBM sequence can be seen in figure~\ref{fig:rbm}.
    The independently characterised state preparation (section~\ref{sec:Stateprep}) and measurement (section~\ref{sec:Measurement}) errors of $\sim 10^{-3}$, and $\sim 10^{-4}$ respectively, are consistent with the measured $\epsilon_{\rm SPAM}$.

\subsection{Spin Coherence Times}
\label{sec:Coherence}
% Main points:
    % Quote coherence times comparing:
        % Mumetal box panels
        % Transitions with diff mag sensitivity
        % FNC/ no-FNC
% Pre reqs:
    % MuMetal box
    % Available transitions
    % 729 laser system
    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=\linewidth]{
            figures/pdf_figure/fnc_coherence.pdf
            }
        \noindent\includegraphics[width=\linewidth]{
            figures/pdf_figure/mag_coherence.pdf
            }
        \end{center}
        \caption{Coherence time measurements.
        \textbf{a)} Coherence time of the $\ket{4S_{1/2},~m_j=-1/2}\leftrightarrow\ket{3D_{5/2},~m_j=-3/2}$ transition with and without fibre noise cancellation (FNC). 
        \textbf{b)} Coherence time of three quadrupole transitions with varying magnetic field sensitivities. The inset plot shows a linear fit between the coherence time and the magnetic field sensitivity of the transition.
            }
        \label{fig:coherence_times}
    \end{figure}
    Decoherence, as can be seen in figure~\ref{fig:Long Flop}, can be caused by laser frequency and power fluctuations, magnetic field noise, and spontaneous emission from the $3D_{5/2}$ level. The coherence time of the qubit is a useful diagnostic for finding unwanted noise sources, and for benchmarking the performance of the qubit as a store of quantum information.\\
    To measure the coherence times, we perform Ramsey sequences with varying delay durations. The Ramsey sequence is as follows:
    \begin{enumerate}
        \item Prepare the qubit in $\ket{\downarrow}$ via optical pumping, section~\ref{sec:Stateprep}.
        \item Apply a $R_y(\pi/2)$ pulse to prepare the qubit in $\ket{+} = \frac{1}{\sqrt{2}}(\ket{\downarrow} + \ket{\uparrow})$ superposition state.
        \item Wait for a time $t_{\rm RAM}$.
        \item Apply a second $R_\phi(\pi/2)$-pulse, with a variable axis of rotation, $\phi$. 
        \item Measure the population in $\ket{\downarrow}$, $P_\downarrow$, via state-selective fluorescence, section~\ref{sec:Measurement}.
        \item Repeat steps 1-5 for different values of $\phi$ and fit the resulting fringe to find the contrast.
        \item Repeat steps 1-6 for different values of $t_{\rm RAM}$ to find the decay in contast with time. The coherence time is defined as the time at which the contrast has decayed to $1/e$ of its initial value.
    \end{enumerate}
    With this tool, the efficacy of the fibre noise cancellation (FNC, see section~\ref{sec:Narrow Line Width 729 Laser}) can be measured. Figure~\ref{fig:coherence_times} $a$ shows the coherence time of the $\ket{4S_{1/2},~m_j=-1/2}\leftrightarrow\ket{3D_{5/2},~m_j=-3/2}$  transition with and without FNC. The coherence time is increased from 1.9(1)~\unit{\ms} to 6.2(3)~\unit{\ms} with FNC, showing that without FNC, the coherence times are limited by laser phase noise. \\
    With FNC enabled, to see if the coherence time is now limited by magnetic field noise, transitions with varying magnetic field sensitivities are compared. Figure~\ref{fig:coherence_times} $b$ shows the coherence time of three quadrupole transitions with varying $D_{5/2}$, $m_j$ numbers: $\ket{4S_{1/2},~m_j=-1/2} \leftrightarrow \ket{3D_{5/2},~m_j=\lbrace -5/2, -3/2, +3/2}$. These transitions have magnetic field sensitivities $-0.446$, $-0.178$, $+0.624$~\unit{\MHz\per\gauss} respectively. The contrast decays for all three qubits are shown in the figure. The inset plot shows a well correlated linear fit between the coherence time and the magnetic field sensitivity, suggesting that the coherence time is limited by magnetic field noise. For both $\ket{4S_{1/2},~m_j=-1/2} \leftrightarrow \ket{3D_{5/2},~m_j=-5/2}$ and $\ket{4S_{1/2},~m_j=-1/2} \leftrightarrow \ket{3D_{5/2},~m_j=+3/2}$, revivals in contrast can be seen which suggest that the dominant noise source is oscillatory and coherent over the Ramsey scan duration.\\
    These measurements were taken without the MuMetal enclosure (section~\ref{sec:Magnetic Field}) fully assembled around the vacuum system, which we expect will greatly reduce external magnetic field noise, and therefore increase the coherence times.


\section{Motion}
\label{sec:Motion}
% Main points:
    % Quote characterisation method and values for various motional measurements.
    % Highlight where we are not yet at the capability we need.
    % State what improvements we plan to add.
% Pre reqs:
    % Motivation for control of motion of ion
    % Trap RF DC
    % Laser systems

    Motion of ions trapped in the same potential can be described by a set of normal modes~\cite{james1998quantum}. These modes are labelled with respect to the ion chain geometry: axial modes oscillate parallel with the chain, and radial modes oscillate perpendicular to the chain. Due to the geometry of the 729-nm beam access with respect to the ion chain (see section~\ref{sec:Vacuum System}), only the radial modes can be addressed in our system. For the \emph{NPL} trap (see section~\ref{sec:The Ion Trap}), the radial modes frequencies are non-degenerate. In our system, for a single ion, the radial mode frequencies are $\omega_{\rm upper}/2\pi = 4.0$~\unit{\MHz}, and $\omega_{\rm lower}/2\pi = 2.5$~\unit{\MHz}, and the axial mode frequency is $\omega_{\rm axial}/2\pi = 1.6$~\unit{\MHz}. All work here is using the upper radial mode. \\
    The motional mode, $i$, leads to sidebands in the 729-nm spectrum at $\omega_0 \pm \omega_{i}$~\cite{ozeri2011tutorial}, where $\omega_0$, the carrier, is the frequency of the 729-nm laser when on resonance with the qubit transition. The $+\omega_i$ sideband is referred to as the blue sideband (BSB), and the $-\omega_i$ is the red sideband (RSB).
    The RSB, BSB, and RF fields near to resonance with the motional modes, are the tools used in this section to manipulatie the motion of the ion.\\
    The motional state preparation, heating rate, frequency stabilities, and coherence times are characterised in this section.

\subsection{Cooling}
\label{sec:Cooling}
% Main points:
    % Introduce why we want to cool
    % Doppler cooling
    % Sideband cooling
% Pre reqs:
    % Motional mode and beam geometry
    % Laser systems 
    % Trapping

    For any interaction that involves the motion of the ion, it is essential to both prepare and measure the motional state with high fidelity. For all motional interactions considered in this thesis, the ion is initially prepared as close as possible to the motional ground state, with a mean phonon number $\bar{n} \approx 0$. This is done by an initial stage of Doppler cooling, followed by pulsed sideband cooling on the 729-nm transition. The final motional state is characterised by measuring the population in Fock states using RSB and effective BSB pulses.\\

\subsubsection{Doppler Cooling}
% Main points:
    % Quote final temperature reached (theory?)
    % Describe cooling parameters
% Pre reqs:
    % Motional mode and beam geometry
    % Laser systems 

    Doppler cooling relies on the fact that light incident on a moving ion 
    appears frequency-shifted in the ion's rest frame. For Doppler cooling
    of \ca, both the 397-nm and 866-nm lasers are applied. The 397-nm laser is red-detuned from the dipole $\ket{4S_{1/2}}\leftrightarrow\ket{4P_{1/2}}$ transition, leading to preferential
    scattering of 397-nm photons that have a net cooling effect~\cite{wineland1979laser}. The excited $4P_{1/2}$ level decays via two channels: emission of a 397-nm photon back to $\ket{4S_{1/2}}$, or an 866-nm photon to $\ket{3D_{3/2}}$, with a branching
    ratio of 14.5~\cite{ramm2013precision}. Since many photon scattering events are required, the cooling cycle must be closed. To prevent population trapping in the metastable $\ket{3D_{3/2}}$ level, the 866-nm laser is applied on resonance during cooling.\\
    Equilibrium
    is reached when the cooling rate balances
    photon recoil heating. Assuming the 397-nm transition is broadened only by its natural linewidth $\gamma$, 
    the minimum Doppler temperature is,
    \begin{equation}
    T_{\rm Doppler} \approx \frac{\hbar\gamma}{2k_B},
    \end{equation}
    where $\hbar$ is the reduced Planck constant, and $k_B$ is Boltzmann's constant~\cite{wineland1979laser}.\\
     For
    $^{40}$Ca$^+$, the natural linewidth of the 397-nm transition is $\frac{\gamma}{2\pi} =
    21$~\unit{\MHz}\cite{morton2003atomic}, giving $T_{\rm Doppler} = 0.5$~\unit{\milli\kelvin}. For a radial mode frequency of $\frac{\omega}{2\pi} = 4$~\unit{\MHz}, the expected mean phonon number is,
    \begin{equation}
        \bar{n} = \frac{1}{e^{\hbar\omega/k_B T}-1},
    \end{equation}
    yielding $\bar{n} = 2.3$ at the Doppler limit.
    The parameters used here for Doppler cooling are summarised in table~\ref{tab:397_parameters}. \\

\subsubsection{Sideband Cooling}
% Main points:
    % Quote final temperature reached
    % Describe SBC pulse sequence
    % We use a closed transition
% Pre reqs:
    % Motional mode spectra
    % Laser systems 
    % Rabi flopping

    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=\linewidth]{
            figures/pdf_figure/pulse_sequence.pdf
            }
        \noindent\includegraphics[width=0.75\linewidth]{
            figures/pdf_figure/sideband_thermometry.pdf
            }

        \end{center}
        \caption{
            \textbf{a)} Example pulse sequence for one experimental shot including pulsed sideband cooling. The \emph{Exp.} block represents an arbitrary sequence of operations, for the experiment under study, such as a thermometry sequence.
            The blue blocks represent Doppler cooling and readout (section~\ref{sec:Measurement}), the green blocks represent qubit state preparation (section~\ref{sec:Stateprep}), the red blocks are RSB pulses with varying durations $t(N)$, and the purple blocks are deshelving pulses. After every 5 sideband cooling pulses, there is an interleaved state preparation sequence to ensure there is no population trapped outside of the closed cooling cycle. The RSB length is linearly increased with pulse number $N$, upto the expected RSB $R(\pi)$-pulse duration for $n=1$.  
            \textbf{b, c)} Thermometry scans after Doppler and sideband cooling. The red points are the populations measured via on-resonance RSB pulses, and the blue points are the populations after a sequence of $R(\pi)$-RSB-$R(\pi)$ with varying RSB probe durations. The dashed lines are fits to a thermal Fock state distribution, with truncation at $n = 100$. The extracted mean occupation number is $\bar{n} = 0.03(1)$, and $\eta\Omega/(2\pi) = 11.6(1)$~\unit{\kHz}. 
            }
        \label{fig:SBC}
    \end{figure}
    \begin{table}
        \begin{center}
        \begin{tabular}{|c|l|}
            \hline
            Parameter & Value \\
            \hline
            729-nm laser power & 3.0~\unit{\mW}\\
            729-nm laser detuning & -4.0~\unit{\MHz}*\\
            729-nm pulse duration $N = 1$ & 2.5~\unit{\us}\\
            729-nm pulse duration $N = N_{\rm max}$ & 33~\unit{\us}  \\
            Repumping 866-nm duration & 14~\unit{\us}\\
            Deshelving 854-nm duration & 5~\unit{\us}\\
            Number of cooling cycles $N_{\rm max}$ & 50\\
            \hline
        \end{tabular}
        \end{center}
        \caption{
            *729-nm detuning is relative to the $\ket{4S_{1/2},~m_j=-1/2} \leftrightarrow \ket{3D_{5/2},~m_j=-5/2}$ transition frequency.\\
            Experimental parameters used for sideband cooling. Other parameters for the repump and deshelve pulses are the same as for state preparation, see table~\ref{tab:state_prep_parameters}. The 729-nm laser is detuned to the RSB resonance for the upper radial mode, $\omega_{\rm upper}/2\pi = 4.0$~\unit{\MHz}, and the pulse duration for $N=N_{\rm max}$ is chosen to be the expected RSB $R(\pi)$-pulse duration for $n=1$. 
            }
        \label{tab:sbc_parameters}
    \end{table}

    To further cool the ions toward their motional ground state, resolved
    sideband cooling is used. As mentioned above, the motion of the ion
    modulates the absorption spectrum of the ion, leading to red and blue sidebands (RSB and BSB). For the $\ket{4S_{1/2}} \leftrightarrow
    \ket{3D_{5/2}}$ transition, at appropriate motional mode
    frequencies, interaction strengths, and using a narrow linewidth laser (section~\ref{sec:Narrow Line Width 729 Laser}), these sidebands can be resolved spectroscopically. The pulsed
    sideband technique employed consists of RSB pulses on the 729-nm transition, followed by
    deshelving, and repumping pulses on the 854-nm and 866-nm transitions
    respectively. 
    For efficient cooling, initial short 729-nm pulses are applied to preferentially excite the thermal population with high phonon number, as the pulse duration for RSB $R(\pi)$ is proportional to $\sqrt{n}$, where $n$ is the phonon number.  The RSB pulse length is linearly increased to the expected RSB $R(\pi)$-pulse duration for $n=1$.\\
    An example pulse sequence for a single experimental shot using sideband cooling, can be seen in
    figure~\ref{fig:SBC} $a$. Experimental parameters used are summarised in table~\ref{tab:sbc_parameters}.\\
    To verify the efficacy of our sideband cooling, thermometry
    experiments are performed by probing Fock state populations. This is done using on resonance RSB pulses and effective BSB pulses composed of a $\pi$-RSB-$\pi$ pulse
    sequences. The time dynamics of population flopping is measured as RSB
    pulse length, $t$, is varied. In the case of Fock state $\ket{0}$, there should be full contrast 
    ``BSB'' oscillations, and no visible oscillations when probed with RSB pulses. A thermal
    Fock state distribution~\cite{meekhof1996generation} (with truncation at Fock state = 100) is fitted to these
    signals to extract the mean occupation number, and $\eta\Omega$, the carrier
    Rabi frequency multiplied by the Lamb-Dicke parameter. A typical thermometry
    scan after Doppler and sideband cooling can be seen in
    figure~\ref{fig:SBC} $b, c$, where $b$ shows the population after effective ``BSB'' pulses, and $c$ shows the population after RSB$(t)$ pulses with duration $t$. These oscillations are fit to thermal Fock state distributions, shown by the dashed lines. The mean occupation
    number after sideband cooling is found to be $\bar{n} = 0.03(1)$, and $\eta\Omega =
    11.6(1)$~\unit{\kHz}.\\

    %Optimisation of the cooling parameters can be roughly performed by fitting
    %temperature while scanning RSB $\pi$-pulse durations, total number of pulses,
    %repumping and deshelving times. One can optimise for minimum temperature,
    %however it is also important to optimise for total cooling duration. For
    %single ion, single mode experiments, this duration is often not a limiting factor for experimental run-times,
    %however for multi-ion crystals, any interaction involving the motion may
    %require the sequential sideband cooling of multiple motional modes. This can
    %not be easily parallalised due to the requirement that the RSB $\pi$-pulse is
    %performed near resonance to one of the motional sidebands. This sequential
    %cooling strategy can be either limiting when heating and cooling rates are
    %comparable, or lead to prohibitive data acquisition times.\\
    %To mitigate this issue, other sub-Doppler cooling techniques with larger
    %accepted mode frequency bandwidths may be employed. Examples are dark-resonance
    %cooling~\cite{reis1996cooling,allcock2016dark-resonance}, electromagnetically induced transparency (EIT) cooling~\cite{roos2000experimental}, and
    %Sisyphus cooling~\cite{cirac1992laser}. These techniques are not yet implemented in our system,
    %but will be likely additions once we move to larger ion crystals.\\

\subsection{Heating Rates}
\label{sec:Heating}
% Main points:
    % Quote motional heating rates for mode we use (have access to).
    % Describe heating model?
% Pre reqs:
    % Thermometry
    % Motional modes
    % Trap

    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=0.75\linewidth]{
            figures/pdf_figure/heating_rate.pdf
            }
        \end{center}
        \caption{
            Heating rates of upper radial mode, measured by varying the delay between cooling and thermometry pulses. The dashed line is a linear fit to the data, with slope $33(3)$~quanta/s. The error bars are given by the standard deviation of the fitted $\bar{n}$.
            }
        \label{fig:heating rates}
    \end{figure}

    After cooling the motion, the ion will return to a temperature in equilibrium with the environment. However, this process can be slowed by adequate isolation of the ion. In UHV ion trap systems (see section~\ref{sec:Vacuum System}), motional heating is predominantly caused by electric field noise from the ion trap~\cite{wineland1998experimental}. Noise due to thermal charge fluctuations at the trap surface can be 
    mitigated by increasing ion-electrode distances. The \emph{NPL} trap (section~\ref{sec:The Ion Trap}), used here, has an ion-electrode 
    distance of 250~\unit{\um}, larger than most surface traps, but less than that of a
    macroscopic blade or rod style trap~\cite{milne2021construction}. Heating rates were probed by a series of thermometry experiments, explained above, with varying delay
    times, $t_{\rm delay}$, between cooling and thermometry pulses. A typical plot can be seen in
    figure~\ref{fig:heating rates}. The heating rate of the system
    was found by a linear fit, shown by the dashed line, to be $33(3)$~quanta per second on the upper radial 4~\unit{\MHz} mode on
    one ion. As will be discussed in section~\ref{sec:Motional Coherence}, the heating rate sets a limit for the motional coherence time.\\

    %It is expected that the heating rate will be larger for lower frequency
    %motional modes if electric field noise is assumed to be uniform over its spectrum~\cite{}. 
    %We also verify
    %this by looking at heating rate on the radial mode while varying the axial
    %mode frequency. This is a useful diagnostic to check for unexpected heating
    %at certain frequencies, perhaps due to RF noise in the lab. We find....\\

\subsection{Motional Mode Stability}
\label{sec:Motional Mode Stability}
% Main points:
    % Quote motional mode drift 
    % Explain why it is currently drifty
    % Outline how this will be improved with the squareatron
% Pre reqs:
    % Trap

    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=\linewidth]{
            figures/pdf_figure/mode_drift.pdf
            }
        \end{center}
        \caption{
            \textbf{a)} Motional mode frequency drift over time. The radial motional mode frequency is measured by exciting motion using an RF field in resonance with the motional frequency, and looking at increased fluorescence. The resulting frequency trace is shown in blue. The green line shows a low pass filter of the data, with cut-off frequency of 1.67~\unit{\mHz}, corresponding to an assumed 10 minutes slow thermal drift. The motional mode frequency is typically calibrated every 10 minutes, which is indicated by the red line. 
            \textbf{b)} Residuals from the measured data and expected calibrated mode frequencies. The standard deviation of these residuals suggests the typical misset detuning of the mode frequency in current experiments with automated mode frequency calibrations every 10 minutes.
            \textbf{c)} Residuals from the measured data and the low passed trace. The standard deviation of these residuals are due to noise with period less than 10 minutes. 
            }
        \label{fig:mode drift}
    \end{figure}

    Due to thermal drifts and microphonics introducing amplitude and frequency noise on the RF chain, drifts of the radial motional mode frequencies are seen over time. As will be discussed in the following section~\ref{sec:Motional Coherence}, this can lead to dephasing of the motional state. Here, the current motional mode stability is characterised to estimate its contribution to dephasing, and to set a benchmark for future stability improvements. \\
    The motional mode frequency is measured via an RF ``tickle'' experiment. This consists of short ($\sim 5$~\unit{\us}) RF field pulses applied to one of the trap DC electrodes which has a non-zero electric field projection to the mode we wish to probe. The frequency of the RF field is scanned around the expected motional mode frequency, and when resonant, drives the motion of the ion. This resonance is measured by observing an increase in fluorescence counts using a 397-nm laser red-detuned by 100~\unit{\MHz}. To measure mode frequency drift, this sequence is repeated every 10 seconds over multiple hours. A typical plot can be seen in figure~\ref{fig:mode drift} $a$. Over this two hour period, the frequency had an absolute drift of 1.5~\unit{\kHz}. Typically, we calibrate the mode frequency every 10 minutes, which is indicated with the red dashed line. Residuals between this calibrated line and the data, shown in $b$, have a standard deviation of $\sigma/(2\pi) = 203(8)$~\unit{\Hz}, giving the expected uncertainty of the mode frequency detuning given our current periodic calibration routine. A slow drift with frequency cut-off of 1.67~\unit{\mHz} is also fitted to the data, shown in green. The residuals from this fit, shown in $c$, have a standard deviation of $\sigma/(2\pi) = 94(4)$~\unit{\Hz}. This suggests that the motional mode frequency is relatively stable over time scales shorter than 10 minutes, but has a slow drift on longer time scales, which is likely due to thermal fluctuations. \\
    
    % Tracking noise source
    % Show resonator scan
    % Explain we sit either on peak or edge
    % show mode drift of +- edge of resonator.
    % This suggests amplitude drift
    % XXX However, we can distinguish between amplitude or resonator frequency drifts by changing the trap RF frequency. Figure~\ref{fig: mode drift} shows the motional mode frequency versus the trap RF frequency. The quadratic responce seen is due to the bandwidth of the resonator. By probing two points If the central frequency of the resonator drifts over time
    

\subsection{Motional Coherence Times}
\label{sec:Motional Coherence}
% Main points:
    % Quote measured result for motional coherence time
    % Give estimate for what times we need for future experiments
    % Give estimate contributions from motional heating and from mode instability
    % What fix will we do for improving this - squareatron from prev section, resonator.
% Pre reqs:
    % Trap RF
    % Trap Resonator
    % Motional mode stability
    % SBC
\begin{figure}
    \begin{center}
    \noindent\includegraphics[width=0.75\linewidth]{
        figures/pdf_figure/motional_coherence.pdf
        }
    \end{center}
    \caption{
        Motional coherence time measured by Ramsey sequence on the motional state. The blue points are the population in $\ket{\downarrow}$ after a Ramsey sequence with varying delay time, $t_{\rm RAM}$. The dashed line is an exponential decay fit, with a coherence time $\tau = 4.6(4)$~\unit{\ms}.
        }
    \label{fig:motional_coherence}
\end{figure}

    We will utilise the motional modes of the ion to store quantum information.
    As with the section on spin coherence times~\ref{sec:Coherence}, the
    fidelity of operations, and success probability of algorithms will be
    limited by the coherence time of the motional state.  To measure motional
    coherence, a Ramsey sequence is performed between states $\ket{\downarrow, 0}$
    and $\ket{\downarrow, 1}$, where the first element is the qubit
    state, and the second element is the motional Fock state. To prepare these
    states the following pulse sequence is applied:
    \begin{enumerate}
    \item State prepare system to $\ket{\downarrow, 0}$ via optical pumping and sideband cooling.
    \item Apply $R_y(\pi/2)$-pulse on carrier transition to prepare the qubit in $(\ket{\downarrow, 0} + \ket{\uparrow, 0})/\sqrt{2}$.
    \item Apply $R(\pi)$-pulse on the RSB to prepare the motional state in $(\ket{\downarrow, 0} + \ket{\downarrow, 1})/\sqrt{2}$.
    \item Delay for some time $t_{\rm RAM}$.
    \item Apply $R(\pi)$-pulse on the RSB to map accumulated phase onto the qubit state.
    \item Apply $R_\phi(\pi/2)$-pulse on the carrier, with variable axis of rotation, $\phi$.
    \item Measure the population in $\ket{\downarrow}$ via state-selective fluorescence, section~\ref{sec:Measurement}.
    \item Repeat steps 1-7 for different values of $\phi$ to find the contrast of the Ramsey fringe.
    \item Repeat steps 1-8 for different values of $t_{\rm RAM}$ to find the decay in contrast with time. The coherence time is defined as the time at which the contrast has decayed to $1/e$ of its initial value.
    \end{enumerate}
    There are two main mechanisms for motional decoherence\cite{turchette2000decoherence}: motional heating, as
    characterised in section~\ref{sec:Heating}, and motional dephasing due to
    mode frequency instability, as discussed in section~\ref{sec:Motional Mode Stability}. \\
    A heating rate dominated coherence time is given by, $\tau_{\rm HEAT} =
    (\sqrt{e}-1)/\dot{\bar{n}}$~\cite{turchette2000decoherence}, where $\dot{\bar{n}}$ is the heating
    rate. A dephasing dominated coherence time, if noise is correlated on timescales long compared to the Ramsey delay~\cite{omalley2015qubit}, is characterised by a Gaussian decay profile with a coherence time
    of $\tau_{DEPH} = \sqrt{2}/\sigma_{\omega}$.\\
    Evaluating both of these models with $\dot{\bar{n}}=33(3)$~q/s, and
    $\sigma_{\omega}/(2\pi) = 94(4)$~\unit{\Hz}, the expected motional coherence times of $\tau_{\rm
    HEAT} \approx 20$~ms and $\tau_{\rm DEPH} \approx 2.3$~ms respectively, are found. From these auxiliary characterisations of the motional modes, it is expected that the coherence time will be limited by motional dephasing. \\
    Figure~\ref{fig:motional_coherence} shows the decaying coherence when probed by the above sequence. It can be seen that the contrast has a good fit assuming an exponential decay (green dashed line),
    defined by $C(t_{\rm RAM}) = C(0) e^{-t_{\rm RAM}/\tau},$ where $C(t_{\rm RAM})$ is the contrast at time $t_{\rm RAM}$, and $\tau$ is the coherence time. The fit yields a motional coherence time of $\tau = 4.6(4)$~\unit{\ms}, defined as the time at which the contrast decays to $1/e$ of its intitial value. 
    An exponential decay suggests that the noise source causing the dephasing is correlated only for durations much shorter than the Ramsey delay times~\cite{omalley2015qubit}.
    The Gaussian decay, (red dashed line), which was appropriate for the previous spin coherence time measurements in section~\ref{sec:Coherence}, is a poor fit here. \\
    
    

    %Work must be done to estimate the fast motional
    %noise, however, first there may be simple improvements that can be made to
    %the RF chain to improve both short and long term motional mode stability.
    %These improvements are described in section~\ref{sec:Trap RF Chain}.\\


\section{Spin-Motion}
    For full control of the spin-motion hybrid system, we require interactions
    that couple the two. Perhaps the simplest of this class of interactions
    are the red- and blue-sidebands (RSB and BSB respectively). The  RSB
    interaction was used previously in the thermometry and sideband cooling
    sections~\ref{sec:Cooling}. The RSB (BSB) consists of a single frequency
    laser tuned at the carrier frequency minus (plus) the motional mode frequency,
    $\omega_m$. The interaction is well described by the (Anti-) Jaynes-Cummings
    Hamiltonian, and effectively couples spin flips with the addition or
    subtraction of a motional quanta depending on the initial spin state. Here,
    another such interaction coupling spin and motion, known as the
    spin-dependent force, SDF, is introduced. 
    While the RSB and BSB interactions couple the spin and motion in the motional Fock basis, the SDF couples them through spin-dependent displacements, thus in a coherent state basis. The direction of the displacement is determined by the spin state and an effective detuning parameter.

\subsection{Spin-Dependent Forces}
\label{sec:Spin-Dependent Forces}
% Main points:
    % This is a primitive for motional control
    % This (we will see), is functionally a primitive for two qubit spin entanglement
    % Show equation as quite key to future work
% Pre reqs:
    % Motional mode spectra
    % 729 system
    % AOM control of 729
    The optical Mlmer-Srensen (MS) scheme~\cite{sorensen2000entanglement} is used to generate the
    SDF via a bichromatic laser field. Bichromatic refers to the simultaneous
    application of two tones symmetrically detuned around the qubit carrier
    frequency, with absolute detuning approximately equal to the motional mode
    frequency, $\delta \approx \omega_{m}$. The resulting interaction, when
    ignoring off-resonant and higher order couplings, is given by,
    \begin{equation}
        \hat{H}_{MS} = i\hbar \eta\Omega\hat{\sigma}_\phi\cos(\delta t) \left( \hat{a} e^{-i\omega_{m} t} + \hat{a}^\dagger e^{i\omega_{m} t} \right),
    \end{equation}
    where $\eta$ is the Lamb-Dicke parameter, $\Omega$ is the carrier Rabi
    frequency, $\hat{a}(\hat{a}^\dagger)$ is the lowering (raising) operator, and
    $\hat{\sigma}_\phi$ is the Pauli operator with $\hat{\sigma}_\phi = \cos(\phi)\hat{\sigma}_x + \sin(\phi)\hat{\sigma}_y$.
    Applying the rotating wave approximation, and defining $\delta_g = \delta -
    \omega_{m}$, the interaction Hamiltonian can be approximated
    to,
    \begin{equation}
        \label{eqn:MS}
        \hat{H}_{MS} \approx \frac{i\hbar \eta\Omega}{2}~\hat{\sigma}_\phi \left( \hat{a} e^{-i\delta_g t} + \hat{a}^\dagger e^{i\delta_g t} \right).
    \end{equation}
    The trajectory of this displacement can be controlled by varying $\delta_g$: on
    resonance, $\delta_g = 0$, corresponds to linear trajectories, whilst off resonance,
    $\delta_g \neq 0$, corresponds to cyclic trajectories where after some duration $t =
    2\pi/\delta_g$, the motion returns to the initial state (with perhaps some phase shift~\cite{haljan2005spin-dependent}). 
    The dynamics of the SDF may be measured by projective spin measurements, the population in $\ket{\downarrow}$, $P_\downarrow$, after applying the SDF for duration $t$ is described by~\cite{burd2020squeezing},
    \begin{equation}
        \label{eqn:sdf_pop}
        P_{\downarrow,\mathrm{th}} = \frac{1}{2} \left[ 1 + e^{-4\left( \bar{n} + \frac{1}{2} \right) |\alpha(t, \delta_g)|^2} \right],
    \end{equation}
    where $\bar{n}$ is the initial thermal phonon occupation, and $|\alpha(t, \delta_g)| = \Omega_{\rm SDF} \sin(\delta_g t/2)/\delta_g$, is the absoltue displacement of the initial state.
    This control is utilised in both two-qubit entangling gate experiments, as well as
    in the creation of squeezed states.\\

\subsubsection{Calibrating the SDF}
% Main points:
    % Here describe what error sources "look like"
    % Describe detuning and duration scans
    % Describe how we can detect these errors via the above strategy. Refer to OB thesis.
    % Fit an SDF with the errors?
% Pre reqs
    % Motional mode spectra
    % 729 system
    % AOM control of 729

    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=\linewidth]{
            figures/pdf_figure/sdf.pdf
            }
        \end{center}
        \caption{
            Detuning and duration scans of the spin-dependent force applied to an initial thermal state with $\bar{n} = 0.03(1)$. 
            \textbf{a)} Detuning scan, where the detuning, $\delta_g$, is varied, and the duration is fixed at $t=100$~\unit{\us}. The green line is a fit to the expected behaviour given by equation~\ref{eqn:sdf_pop}. 
            \textbf{b)} Detuning scan with a misset qubit frequency of $0.5$~\unit{\kHz}. The green line is the same fit as in $a$ to guide the eye. 
            \textbf{c)} Duration scan, where the duration, $t$, is varied, and the detuning is fixed at $\delta_g = 0$. The dashed line is a fit to the expected behaviour given by equation~\ref{eqn:sdf_pop} with only $\Omega_{\rm SDF}$ as a free parameter.
            }
        \label{fig:SDF}
    \end{figure}

    Geometric phase gates, such as the MS interaction, are widely employed in ion trap experiments due to their robustness against variations in initial motional state. However, the SDF is sensitive to various frequency and power miscalibrations and drifts of these between calibrations.  Here, we describe the workflow for calibrating and optimising the SDF behaviour.\\
    In practice, the SDF interaction involves relatively few degrees of freedom: the central qubit frequency, the motional mode frequency, the power in each tone, and the durations of the pulses must all be calibrated. The complexity comes from the fact that the ion is a multi-level system, posseses multiple motional modes, and that each experimental parameter can only be controlled with finite precision.\\
    The effect of nearby motional modes is negated by either selecting the
    interaction mode to be well seperated from the others either in frequency, by beam geometry, by
    operating the SDF near to resonance of the desired mode, or by using amplitude shaping of the pulse.
    Smoothing a square pulse through amplitude shaping narrows the pulse frequency bandwidth, and thus reduces unwanted off-resonant
    excitation of other modes.  \\
    The power balance of the SDF tones is complicated due to our use of AOMs.
    AOMs generate frequency shifts in the laser beam at the expense of small
    frequency-dependent angular shifts. After the AOM, the beam is coupled into a
    single mode fibre (see figure~\ref{fig:729}), and so the AOMs effectively introduce a
    frequency-dependent loss. To calibrate the power balance, a pick
    off of the bichromatic beam after the ion is monitored on a high bandwidth photodiode.
    The beatnote contrast is measured for the two tones and the power
    balance is optimised by maximising this contrast.\\
    The far off-resonant levels of our ion lead to light-shifts of our qubit
    frequency. To account for the light-shift the central qubit frequency must be calibrated at the
    optical power used for the interaction. This is done with the SDF interaction
    itself. When the qubit frequency is set incorrectly, the two tones will no
    longer have the same absolute detuning from their respective RSB or BSB.
    This manifests as a ``skewness'' of the SDF detuning trace. By varying the qubit frequency and
    inspecting these detuning scans, the desired SDF behaviour can be found. \\
    To verify the behaviour of the calibrated SDF, the experimental data is compared with theory. Both
    ``detuning'' and ``duration'' scans are used. The ``detuning'' scan is performed by
    varying the detuning, $\delta_g$, of the interaction, whilst keeping the
    SDF duration, $t$, constant, and vice-versa for the ``duration'' scan. \\
    Figure~\ref{fig:SDF} $c$ shows the measured duration scan described by equation~\ref{eqn:sdf_pop}, with $\delta_g = 0$ and the the motional state assumed to be thermal with average Fock state $\bar{n}
    = 0.03(1)$ which was found previously from thermometry measurements.
    Here, the displacement, $|\alpha(t)| = \Omega_{\rm SDF} t/2$, where $\Omega_{\rm SDF}$ is the
    SDF amplitude. The dashed line fit is given by floating $\Omega_{\rm SDF}$ only, and finds $\Omega_{\rm SDF}/(2\pi) = 6.6(2)$~\unit{kHz}.
    These measurements were performed with total 729-nm power of 2~mW and $\delta_{\rm LS}/(2\pi) = 3.5$~\unit{\kHz}, the light shift due to the 729-nm laser relative to the unperturbed qubit frequency. \\
    The detuning scan, shown in figure~\ref{fig:SDF} $a$, has the same experimental parameters, but with fixed duration $t=100$~\unit{us}. The fit in green is taking the 
    displacement to be $|\alpha(t)| = \Omega_{\rm SDF} \sin(\delta_g t/2)/\delta_g$, given the value for $\Omega_{\rm SDF}$ measured from the duration scan. Here,
    a qualitatively good agreement between the measured data and the
    expected behaviour is seen, with the main features being the ``closure''
    at $\delta_g = 2\pi/t$ where the motional state returns to the initial state,
    and the central flat region around $P_{\downarrow, \mathrm{th}} =0.5$ where
    the two motional wave packets are non-overlapping.\\
    Figure $b$ shows an example detuning scan when the qubit frequency is misset by $0.5$~\unit{\kHz}. The central region now displays a clear assymmetry around $\delta_g = 0$. The green line here is the fit from $a$ to guide the eye.


\subsection{Two-Qubit Entangling Gates}
\label{sec:Two-Qubit Entangling Gates}
% Main points:
    % Intro/brief outline of goal of two-qubit gate. Truth table? Preparing in Bell state. This is tool kit for spin control of our system.
    % Discuss likely limitations being nearby hot motional modes, no pulse ramping
    % Current error vs what we expect we need for future experiments.
    % Here empasise that the SDF we discuss previously can be used to generate entanglement.
    % Showing phase coherence between operations is nice here.
% Prereqs:
    % SDFs
    % Single qubit gates
    % What available transitions we have
    % Motional mode spectra

    \begin{figure}
        \begin{center}
        \noindent\includegraphics[width=\linewidth]{
            figures/pdf_figure/ms_gate.pdf
            }
        \end{center}
        \caption{
            Experimental data for $\mathcal{F}=92(2)$\% Mlmer-Srensen (MS) two-qubit entangling gate.
            \textbf{a)} Populations versus duration scan of the MS interaction.
            Each point corresponds to the average of 200 shots, and the error
            bars are given by the standard deviation of these averages. The blue
            points are the populations of both ions being in the $\ket{0}$
            state, $P_{00}$, the green points are the populations of both ions
            being in the $\ket{1}$ state, $P_{11}$, and the red points are the
            ions being the the opposite states, $(P_{01}+P_{10})/2$. The desired
            entangling gate corresponds here to $t_g =  75$\unit{\us}. 
            \textbf{b)} Parity oscillations after the MS interaction. The parity
            is defined as $P_{00} + P_{11} - P_{01} - P_{10}$. The fitted
            contrast here is $0.90(2)$.
            \textbf{c)} Populations at the desired entangling gate duration, $t_g =
            75$~\unit{us}.  
            }
        \label{fig:ms_gate}
    \end{figure}

    We perform two-qubit entangling gates using the Mlmer-Srensen (MS)
    interaction~\cite{sorensen2000entanglement}. This interaction is the same described SDF from the
    previous section, but applied globally to two ions. The MS interaction
    relies on the spin dependent geometric phase accumulated during the motional
    displacement~\cite{ozeri2011tutorial}. To create a two-qubit entangled state, a differential
    geometric phase of $\pi/2$ must be accumulated between the two-qubit basis
    states~\cite{ozeri2011tutorial}. To ensure there is no residual motional entanglement, the final
    motional state must return to the initial state. In practise, using an SDF
    detuned by $\delta_g$, this is achieved by applying the MS interaction for a
    duration $t_g = 2n\pi/\delta_g$, where $n$ is the number of ``loops''. The MS gate is a universal two-qubit gate, and
    along with only single qubit gates, constitutes a universal gate set for
    discrete quantum algorithms.\\  
    Here we quote the current fidelity of experimentally demonstrated two-qubit gates on
    our system. The fidelity serves to quantify the similarity of
    two density matrices. 
    %---------------
    %For the use case of quantum information processing, what we
    %care about is that the experimental unitary applied in the gate sequence closely resembles the unitary we desire theoretically. In general this
    %means that the fidelity of the applied unitary should be measured in an input
    %state agnostic way. Unfortunately, this is often not practical as the input
    %state space can be unwieldly, and the act of preparing the input state can
    %also be error prone. As a compromise, the unitary is tested with either
    %one, or a set of input states, and the fidelity of the output state
    %is measured with respect to the known target state. 
    %---------------
    %Gate performance, quantified by the fidelity, can be measured by tomography~\cite{}.
    %While full quantum process tomography provides an input-independent measure of fidelity, it is often impractical due to the size of the state space and preparation errors. Instead, the unitary is typically tested on one or a few input states, with fidelity evaluated against the expected output.
    %---------------
    %If the error mechansisms of the 
    %unitary are well understood, arguments can be made that this measured
    %fidelity for a set of input state is representative (or not representative)
    %of the average fidelity over the input state space~\cite{}.\\
    %---------------
    Here for a two-qubit entangling gate, we target the creation of the Bell
    state $\ket{\Phi^+_{\phi_0}} = 1/\sqrt{2} \left( \ket{00} +
    e^{i\phi_0}\ket{11} \right)$, from an initial state of $\ket{00}$, where $phi_0$, is some fixed phase.
    The fidelity between our mixed state $\rho$, and the pure Bell state may be
    given by,
    \begin{equation}
        \mathcal{F} = \bra{\Phi^+_{\phi_0}} \rho \ket{\Phi^+_{\phi_0}} = \frac{1}{2} \left( \rho_{00,00} + \rho_{11,11} \right) + \frac{1}{2}\left( e^{i\phi_0}\rho_{11,00}+e^{-i\phi_0}\rho_{00,11}\right),
        \label{eq:Fidelity}
    \end{equation}
    where $\rho_{ij,kl} = \braket{ij|\rho|kl}$. To extract the fidelity experimentally, a partial state tomography 
    protocol is used~\cite{sackett2000experimental}, where the first bracketted term of
    equation~\ref{eq:Fidelity} is measured by performing projective measurements
    of the two ions after the gate sequence to extract populations, and the second bracketted term,
    known as the coherence terms, are measured by applying a global analysis
    $R_\phi(\pi/2)$ pulse to the two ions and applying parity measurements. 
    Parity measurements are defined as $P = P_{00} + P_{11} - P_{01} - P_{10}$, where $P_{ij}$ is the population of the two ions in state $\ket{i}\ket{j}$ after the gate sequence and variable $\pi/2$-pulse. 
    Creating a Bell state is essential for two-qubit entanglement, but its basis can vary as long as it is consistent across experiments. This allows the Bell state phase, $\phi_0$, to float, which in practice means using only the amplitude of the fitted parity oscillations to compute fidelity, ignoring any phase offset.\\
    The best two-qubit entangling gate fidelity currently achieved on our system is $\mathcal{F}=92(2)\%$. As shown in figure~\ref{fig:ms_gate}, the magnitude of the parity scan was measured to be 0.90(2), while the populations $\left( \rho_{00,00} + \rho_{11,11} \right) = 0.95(2)$. Each population point in these figures are found by taking the average of 200 shots of the gate sequence.\\
    These results serve as both a proof of principle for full spin control on
    our system, but also as a benchmark to which we can compare future system
    improvements.  For future work, we will require the use of this entangling
    gate either as Bell state preparation for input to analogue simulation
    experiments~\cite{bazavan2023synthetic}, or as a primitive gate for the spin component of hybrid
    algorithms~\cite{varona2024towards,brenner2024factoring}.  In both these cases, especially any use that requires
    multiple concatenated entangling gates, we will likely require improved gate
    fidelities. 
    Current gate fidelities are limited by the motional dephasing. The gate error due to motional dephasing follows (see section 4.4.6~\cite{ballance2017high-fidelity})
    \begin{equation}
        \epsilon_{\rm DEPH} = 0.686 \frac{t_g}{\tau_{\rm DEPH}},
    \end{equation}
    where for these experiments we estimate a motional coherence time of approximately $\tau_{\rm DEPH} = 1$~\unit{\ms}. Given the gate duration of $t_g = 75$~\unit{\us}, this gives a dephasing error of $\epsilon_{\rm DEPH} = 0.05$, or approximately 5\%. This is the dominant error source in our current gate fidelity, and can be improved by decreasing the gate duration, or by improving the mode frequency stability. We have not yet attempted to optimise these gates, nor have we attempted to fully account for the observed errors. However, this work serves as a benchmark for future improvements, and a demonstration of the full spin control capabilities of our system. \\
    